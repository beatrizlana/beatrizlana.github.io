<!DOCTYPE html>

<html>

<head>
	<title>Order</title>
	
	<link rel="stylesheet" type="text/css" href="styles.css">
	
	<script>
		basket = [];
		
		function getBasket()
		{
			var strbasket = (localStorage.basket).split("},");
			var temp;
			for(var i=0; i<strbasket.length; i++)
			{
				if(i == strbasket.length - 1)
				{
					temp = strbasket[i];
				}
				else
				{
					temp = strbasket[i]+"}";
				}
				console.log("temp: "+temp);
				basket.push(JSON.parse(temp));
				console.log("bskt: "+basket);
			}
		}
		
		function showBasket()
		{
			var list = "Selected products:";
			for(var i=0; i<basket.length; i++)
			{
				if(i == 0)
				{
					list += "<ol><li>Code: "+basket[i].id+" &nbsp;&nbsp;Price: "+basket[i].price+"</li>";
				}
				else if(i == basket.length - 1)
				{
					list += "<li>Code: "+basket[i].id+" &nbsp;&nbsp;Price: "+basket[i].price+"</li></ol>";
				}
				else
				{
					list += "<li>Code: "+basket[i].id+" &nbsp;&nbsp;Price: "+basket[i].price+"</li>";
				}
			}
			document.getElementById("basketlist").innerHTML = list;
		}
		
		function validateOrder()
		{
			result = true;
			contentName = order.name.value;
			contentEmail = order.email.value;
			contentPhone = order.phone.value;
			
			var alertMsg = "";
			var validName = /^[A-Za-z]+[\s][A-Za-z\s\'-]+[A-Za-z]$/;
			var validEmail = /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}$/;
			var validPhone = /^[+][0-9]{5,15}/;
			
			if(contentName == "")
			{
				result = false;
				document.getElementById('name').style.border = "solid firebrick 1px";
				alertMsg += "Please fill out your full name\n";
			}
			else if(!(validName.test(contentName)))
			{
				result = false;
				alertMsg += contentName+" is not a valid name.\n";
			}
			
			if(contentEmail == "")
			{
				result = false;
				document.getElementById('email').style.border = "solid firebrick 1px";
				alertMsg += "Please fill out your email\n";
			}
			else if(!(validEmail.test(contentEmail)))
			{
				result = false;
				alertMsg += contentEmail+" is not a valid email.\n";
			}
			
			if(contentPhone == "" || contentPhone == "+353")
			{
				result = false;
				document.getElementById('phone').style.border = "solid firebrick 1px";
				alertMsg += "Please fill out your phone number\n";
			}
			else if(!(validPhone.test(contentPhone)))
			{
				result = false;
				alertMsg += contentPhone+" is not a valid phone number. (Format:+353778889999)\n";
			}
			
			if(!result)
				window.alert(alertMsg);
			return result;
		}
	</script>
</head>

<body onload="getBasket(); showBasket()">
	<div id="header">
		<div id="branding">
			<img src="images/logo.png" ></img>
		</div> <!-- end of branding -->

		<div id="navigation">
			<ul>
				<li><a href="home.html">Home</a></li>
				<li><a href="aboutus.html">About Us</a></li>
				<li><a href="products.html">Products</a></li>
				<li><a href="items.html">Order</a></li>
				<li><a href="contact.html">Contact Us</a></li>
			</ul>
		</div> <!-- end of navigation -->
	</div> <!-- end of header -->
	
	<div id="tagline">
			
	</div> <!-- end of tagline -->
		
	<div id="bodycontent">

		<form action="confirmation.html" method="post" class="order" id="order" onsubmit="return validateOrder()">
			<fieldset>
				<div id="basketlist"></div>
				<label for="name">Full Name:</label>
				<input type="text" name="name" id="name"><br>
				<label for="email">Email:</label>
				<input type="text" name="email" id="email"><br>
				<label for="phone">Phone Number:</label>
				<input type="text" name="phone" id="phone" value="+353"><br>
				<br><br><input type="submit" value="Submit">
			</fieldset>
		</form>
	</div> <!-- end of body content -->
	
</body>
</html>